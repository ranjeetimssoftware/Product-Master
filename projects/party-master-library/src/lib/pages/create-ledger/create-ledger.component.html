<div class="my-2 d-flex justify-content-between align-items-center">
  <div class="col-md-6 px-0">
    <h5 class="mb-0 heading">New Ledger</h5>
  </div>
  <div class="pe-5 col-md-6 d-flex justify-content-end">
    <button class="btn mr-2 px-4" id="save" (click)="submit()">SAVE</button>
    <button class="btn px-4" id="back" (click)="goBack()">BACK</button>
  </div>
</div>
<div class="border-bottom mb-3"></div>

<div class="container">
  <form [formGroup]="ledgerForm" (ngSubmit)="submit()">
    <div class="row">
      <div class="col-md-9">
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="accountCode" class="form-label mr-2"
              >Account Code<span class="star mx-2">*</span></label
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="17"
              height="17"
              viewBox="0 0 17 17"
              fill="none"
            >
              <path
                d="M9.03125 11.6875V7.4375H6.90625V8.5H7.96875V11.6875H6.375V12.75H10.625V11.6875H9.03125ZM8.5 4.25C8.34239 4.25 8.18833 4.29674 8.05728 4.3843C7.92623 4.47186 7.8241 4.59631 7.76378 4.74192C7.70347 4.88753 7.68769 5.04776 7.71844 5.20234C7.74918 5.35692 7.82508 5.49891 7.93652 5.61035C8.04797 5.7218 8.18996 5.79769 8.34454 5.82844C8.49912 5.85919 8.65934 5.84341 8.80495 5.78309C8.95056 5.72278 9.07502 5.62064 9.16258 5.48959C9.25014 5.35855 9.29688 5.20448 9.29688 5.04688C9.29688 4.83553 9.21292 4.63284 9.06348 4.4834C8.91403 4.33396 8.71134 4.25 8.5 4.25Z"
                fill="#9E9E9E"
              />
              <path
                d="M8.5 15.9375C7.02901 15.9375 5.59104 15.5013 4.36795 14.6841C3.14486 13.8668 2.19158 12.7052 1.62865 11.3462C1.06572 9.98719 0.918435 8.49175 1.20541 7.04902C1.49239 5.60629 2.20074 4.28105 3.2409 3.2409C4.28105 2.20074 5.60629 1.49239 7.04902 1.20541C8.49175 0.918435 9.98719 1.06572 11.3462 1.62865C12.7052 2.19158 13.8668 3.14486 14.6841 4.36795C15.5013 5.59104 15.9375 7.02901 15.9375 8.5C15.9375 10.4726 15.1539 12.3643 13.7591 13.7591C12.3643 15.1539 10.4726 15.9375 8.5 15.9375ZM8.5 2.125C7.23915 2.125 6.00661 2.49889 4.95824 3.19938C3.90988 3.89988 3.09278 4.89552 2.61027 6.0604C2.12776 7.22528 2.00152 8.50707 2.2475 9.7437C2.49348 10.9803 3.10064 12.1162 3.9922 13.0078C4.88376 13.8994 6.01967 14.5065 7.2563 14.7525C8.49293 14.9985 9.77473 14.8722 10.9396 14.3897C12.1045 13.9072 13.1001 13.0901 13.8006 12.0418C14.5011 10.9934 14.875 9.76086 14.875 8.5C14.875 6.80925 14.2034 5.18774 13.0078 3.9922C11.8123 2.79665 10.1908 2.125 8.5 2.125Z"
                fill="#9E9E9E"
              />
            </svg>
          </div>
          <div class="col-11 col-md-5">
            <input
              type="text"
              id="accountCode"
              class="form-control px-2 py-1"
              formControlName="AccountCode"
            />
          </div>
        </div>
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="accountType" class="form-label mr-2"
              >Account Type<span class="star mx-2">*</span></label
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="17"
              height="17"
              viewBox="0 0 17 17"
              fill="none"
            >
              <path
                d="M9.03125 11.6875V7.4375H6.90625V8.5H7.96875V11.6875H6.375V12.75H10.625V11.6875H9.03125ZM8.5 4.25C8.34239 4.25 8.18833 4.29674 8.05728 4.3843C7.92623 4.47186 7.8241 4.59631 7.76378 4.74192C7.70347 4.88753 7.68769 5.04776 7.71844 5.20234C7.74918 5.35692 7.82508 5.49891 7.93652 5.61035C8.04797 5.7218 8.18996 5.79769 8.34454 5.82844C8.49912 5.85919 8.65934 5.84341 8.80495 5.78309C8.95056 5.72278 9.07502 5.62064 9.16258 5.48959C9.25014 5.35855 9.29688 5.20448 9.29688 5.04688C9.29688 4.83553 9.21292 4.63284 9.06348 4.4834C8.91403 4.33396 8.71134 4.25 8.5 4.25Z"
                fill="#9E9E9E"
              />
              <path
                d="M8.5 15.9375C7.02901 15.9375 5.59104 15.5013 4.36795 14.6841C3.14486 13.8668 2.19158 12.7052 1.62865 11.3462C1.06572 9.98719 0.918435 8.49175 1.20541 7.04902C1.49239 5.60629 2.20074 4.28105 3.2409 3.2409C4.28105 2.20074 5.60629 1.49239 7.04902 1.20541C8.49175 0.918435 9.98719 1.06572 11.3462 1.62865C12.7052 2.19158 13.8668 3.14486 14.6841 4.36795C15.5013 5.59104 15.9375 7.02901 15.9375 8.5C15.9375 10.4726 15.1539 12.3643 13.7591 13.7591C12.3643 15.1539 10.4726 15.9375 8.5 15.9375ZM8.5 2.125C7.23915 2.125 6.00661 2.49889 4.95824 3.19938C3.90988 3.89988 3.09278 4.89552 2.61027 6.0604C2.12776 7.22528 2.00152 8.50707 2.2475 9.7437C2.49348 10.9803 3.10064 12.1162 3.9922 13.0078C4.88376 13.8994 6.01967 14.5065 7.2563 14.7525C8.49293 14.9985 9.77473 14.8722 10.9396 14.3897C12.1045 13.9072 13.1001 13.0901 13.8006 12.0418C14.5011 10.9934 14.875 9.76086 14.875 8.5C14.875 6.80925 14.2034 5.18774 13.0078 3.9922C11.8123 2.79665 10.1908 2.125 8.5 2.125Z"
                fill="#9E9E9E"
              />
            </svg>
          </div>
          <!-- <div class="col-11 col-md-5">

            <select
              id="accountType"
              class="form-control px-2 py-1"
              formControlName="AccountType"
              type="text"
            ></select>
          </div> -->

          <div class="dropdown col-11 col-md-5">
            <button
              class="btn dropdown-toggle w-100 d-flex justify-content-between align-items-center"
              type="button"
              id="accountsDropdown"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <!-- Display selected value or default text -->
              {{ selectedAccount ? selectedAccount : "Select Account Type" }}
            </button>

            <ul
              class="dropdown-menu py-1 col-md-11"
              aria-labelledby="accountsDropdown"
              style="max-height: 180px; overflow-y: auto; overflow-x: hidden"
            >
              <input type="text" placeholder="Search" class="search-form" />

              <!-- Dropdown options with (click) event to set selectedAccount -->
              <li>
                <a
                  class="dropdown-item p-1"
                  (click)="selectedAccount = 'Assets'"
                >
                  <div class="d-flex">
                    <label class="ml-2"> Assets</label>
                  </div>
                </a>
              </li>
              <li>
                <a
                  class="dropdown-item p-1"
                  (click)="selectedAccount = 'Liabilities'"
                >
                  <div class="d-flex">
                    <label class="ml-2"> Liabilities</label>
                  </div>
                </a>
              </li>
              <li>
                <a
                  class="dropdown-item p-1"
                  (click)="selectedAccount = 'Equity'"
                >
                  <div class="d-flex">
                    <label class="ml-2"> Equity</label>
                  </div>
                </a>
              </li>
              <li>
                <a
                  class="dropdown-item p-1"
                  (click)="selectedAccount = 'Direct Income'"
                >
                  <div class="d-flex">
                    <label class="ml-2"> Direct Income</label>
                  </div>
                </a>
              </li>
              <li>
                <a
                  class="dropdown-item p-1"
                  (click)="selectedAccount = 'Indirect Income'"
                >
                  <div class="d-flex">
                    <label class="ml-2"> Indirect Income</label>
                  </div>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="accountName" class="form-label mr-2"
              >Account Name<span class="star mx-2">*</span></label
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="17"
              height="17"
              viewBox="0 0 17 17"
              fill="none"
            >
              <path
                d="M9.03125 11.6875V7.4375H6.90625V8.5H7.96875V11.6875H6.375V12.75H10.625V11.6875H9.03125ZM8.5 4.25C8.34239 4.25 8.18833 4.29674 8.05728 4.3843C7.92623 4.47186 7.8241 4.59631 7.76378 4.74192C7.70347 4.88753 7.68769 5.04776 7.71844 5.20234C7.74918 5.35692 7.82508 5.49891 7.93652 5.61035C8.04797 5.7218 8.18996 5.79769 8.34454 5.82844C8.49912 5.85919 8.65934 5.84341 8.80495 5.78309C8.95056 5.72278 9.07502 5.62064 9.16258 5.48959C9.25014 5.35855 9.29688 5.20448 9.29688 5.04688C9.29688 4.83553 9.21292 4.63284 9.06348 4.4834C8.91403 4.33396 8.71134 4.25 8.5 4.25Z"
                fill="#9E9E9E"
              />
              <path
                d="M8.5 15.9375C7.02901 15.9375 5.59104 15.5013 4.36795 14.6841C3.14486 13.8668 2.19158 12.7052 1.62865 11.3462C1.06572 9.98719 0.918435 8.49175 1.20541 7.04902C1.49239 5.60629 2.20074 4.28105 3.2409 3.2409C4.28105 2.20074 5.60629 1.49239 7.04902 1.20541C8.49175 0.918435 9.98719 1.06572 11.3462 1.62865C12.7052 2.19158 13.8668 3.14486 14.6841 4.36795C15.5013 5.59104 15.9375 7.02901 15.9375 8.5C15.9375 10.4726 15.1539 12.3643 13.7591 13.7591C12.3643 15.1539 10.4726 15.9375 8.5 15.9375ZM8.5 2.125C7.23915 2.125 6.00661 2.49889 4.95824 3.19938C3.90988 3.89988 3.09278 4.89552 2.61027 6.0604C2.12776 7.22528 2.00152 8.50707 2.2475 9.7437C2.49348 10.9803 3.10064 12.1162 3.9922 13.0078C4.88376 13.8994 6.01967 14.5065 7.2563 14.7525C8.49293 14.9985 9.77473 14.8722 10.9396 14.3897C12.1045 13.9072 13.1001 13.0901 13.8006 12.0418C14.5011 10.9934 14.875 9.76086 14.875 8.5C14.875 6.80925 14.2034 5.18774 13.0078 3.9922C11.8123 2.79665 10.1908 2.125 8.5 2.125Z"
                fill="#9E9E9E"
              />
            </svg>
          </div>
          <div class="col-11 col-md-5">
            <input
              type="text"
              id="accountName"
              class="form-control px-2 py-1"
              formControlName="AccountName"
            />
          </div>
        </div>
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="parentGroup" class="form-label mr-2"
              >Parent Group<span class="star mx-2">*</span></label
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="17"
              height="17"
              viewBox="0 0 17 17"
              fill="none"
            >
              <path
                d="M9.03125 11.6875V7.4375H6.90625V8.5H7.96875V11.6875H6.375V12.75H10.625V11.6875H9.03125ZM8.5 4.25C8.34239 4.25 8.18833 4.29674 8.05728 4.3843C7.92623 4.47186 7.8241 4.59631 7.76378 4.74192C7.70347 4.88753 7.68769 5.04776 7.71844 5.20234C7.74918 5.35692 7.82508 5.49891 7.93652 5.61035C8.04797 5.7218 8.18996 5.79769 8.34454 5.82844C8.49912 5.85919 8.65934 5.84341 8.80495 5.78309C8.95056 5.72278 9.07502 5.62064 9.16258 5.48959C9.25014 5.35855 9.29688 5.20448 9.29688 5.04688C9.29688 4.83553 9.21292 4.63284 9.06348 4.4834C8.91403 4.33396 8.71134 4.25 8.5 4.25Z"
                fill="#9E9E9E"
              />
              <path
                d="M8.5 15.9375C7.02901 15.9375 5.59104 15.5013 4.36795 14.6841C3.14486 13.8668 2.19158 12.7052 1.62865 11.3462C1.06572 9.98719 0.918435 8.49175 1.20541 7.04902C1.49239 5.60629 2.20074 4.28105 3.2409 3.2409C4.28105 2.20074 5.60629 1.49239 7.04902 1.20541C8.49175 0.918435 9.98719 1.06572 11.3462 1.62865C12.7052 2.19158 13.8668 3.14486 14.6841 4.36795C15.5013 5.59104 15.9375 7.02901 15.9375 8.5C15.9375 10.4726 15.1539 12.3643 13.7591 13.7591C12.3643 15.1539 10.4726 15.9375 8.5 15.9375ZM8.5 2.125C7.23915 2.125 6.00661 2.49889 4.95824 3.19938C3.90988 3.89988 3.09278 4.89552 2.61027 6.0604C2.12776 7.22528 2.00152 8.50707 2.2475 9.7437C2.49348 10.9803 3.10064 12.1162 3.9922 13.0078C4.88376 13.8994 6.01967 14.5065 7.2563 14.7525C8.49293 14.9985 9.77473 14.8722 10.9396 14.3897C12.1045 13.9072 13.1001 13.0901 13.8006 12.0418C14.5011 10.9934 14.875 9.76086 14.875 8.5C14.875 6.80925 14.2034 5.18774 13.0078 3.9922C11.8123 2.79665 10.1908 2.125 8.5 2.125Z"
                fill="#9E9E9E"
              />
            </svg>
          </div>
          <!-- <div class="col-11 col-md-5">

            <select
              id="parentGroup"
              class="form-control px-2 py-1"
              formControlName="ParentGroup"
              type="text"
            ></select>
          </div> -->

          <div class="dropdown col-11 col-md-5">
            <button
              class="btn dropdown-toggle w-100 d-flex justify-content-between align-items-center"
              type="button"
              id="parentGroupDropdown"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              Select Parent Group
            </button>

            <ul
              class="dropdown-menu py-1 col-md-11"
              aria-labelledby="parentGroupDropdown"
            >
              <input type="text" placeholder="Search" class="search-form" />

              <li>
                <a class="dropdown-item p-1">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <label class="ml-2"> Fixed Assets </label>
                    <mat-icon>chevron_right</mat-icon>
                  </div>
                </a>
              </li>
              <li class="dropdown-submenu">
                <a class="dropdown-item p-1">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <label class="ml-2"> Current Assets</label>
                    <mat-icon>chevron_right</mat-icon>
                  </div>
                </a>
                <!-- Nested Dropdown Menu -->
                <ul class="dropdown-menu col-md-8">
                  <input type="text" placeholder="Search" class="search-form" />
                  <li>
                    <a class="dropdown-item p-1">
                      <div
                        class="d-flex justify-content-between align-items-center"
                      >
                        <label class="ml-2"> Cash & Bank</label>
                        <mat-icon>chevron_right</mat-icon>
                      </div>
                    </a>
                  </li>
                  <li>
                    <a class="dropdown-item p-1">
                      <div
                        class="d-flex justify-content-between align-items-center"
                      >
                        <label class="ml-2"> Bills Receiveable</label>
                        <mat-icon>chevron_right</mat-icon>
                      </div>
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>

        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="category" class="form-label mr-2">Category</label>
          </div>
          <div class="col-11 col-md-5">
            <select
              id="category"
              class="form-control px-2 py-1"
              formControlName="Category"
              type="text"
            >
              <option>Cash a/c</option>
              <option>Bank a/c</option>
              <option>Bank Overdraft a/c</option>
              <option>Tds a/c</option>
            </select>
          </div>
        </div>

        <!-- This form entry field displays if category -> bank a/c selected -->
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="crreditLimit" class="form-label mr-2"
              >Credit Limit
            </label>
          </div>
          <div class="col-11 col-md-5">
            <input
              type="text"
              id="crreditLimit"
              class="form-control px-2 py-1"
              formControlName="CreditLimit"
              placeholder="Enter Credit Limit"
            />
          </div>
        </div>

        <!-- This form entry field displays if category -> TDS a/c selected -->
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="tds" class="form-label mr-2">TDS % </label>
          </div>
          <div class="col-11 col-md-5">
            <input
              type="text"
              id="tds"
              class="form-control px-2 py-1"
              formControlName="Tds"
              placeholder="Enter TDS percentage"
            />
          </div>
        </div>

        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="activityType" class="form-label mr-2"
              >Activity Type</label
            >
          </div>
          <div class="col-11 col-md-5">
            <select
              id="activityType"
              class="form-control px-2 py-1"
              formControlName="ActivityType"
              type="text"
            ></select>
          </div>
        </div>
        <div class="row mt-3 mb-2">
          <div class="col-12 col-md-8 offset-md-3">
            <input
              type="checkbox"
              formControlName="HasSubLedger"
              class="mr-2"
            />Has Sub Ledger
          </div>
        </div>
        <div class="row mt-3 mb-3">
          <div class="col-11 col-md-4 offset-md-3">
            <input
              type="checkbox"
              formControlName="AllBranches"
              class="mr-2"
            />Is Applicable for all branches
          </div>
        </div>
        <div class="row d-flex align-items-center mb-2">
          <div class="col-12 col-md-3">
            <label for="branches" class="form-label mr-2">Branches</label>
          </div>
          <div class="col-11 col-md-5 d-flex">
            <button mat-button (click)="openDialog()" id="save" class="w-100">
              <span>Select Branch</span>
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </div>
  </form>

  <!-- Branch Name Table -->
  <div class="table-container col-md-6 mt-3">
    <table mat-table [dataSource]="branchDataSource">
      <!-- SN Column -->
      <ng-container matColumnDef="sn">
        <th mat-header-cell *matHeaderCellDef>SN</th>
        <td mat-cell *matCellDef="let element">{{ element.sn }}</td>
      </ng-container>

      <!-- Branch Column -->
      <ng-container matColumnDef="branch">
        <th mat-header-cell *matHeaderCellDef>Branch Name</th>
        <td mat-cell *matCellDef="let element">{{ element.branch }}</td>
      </ng-container>

      <!-- Action Column -->
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let element">
          <mat-icon class="text-danger">delete</mat-icon>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</div>

<!-- Branch selection popup -->
<div class="custom-popup" *ngIf="isOpen">
  <div class="popup-content">
    <div
      class="d-flex justify-content-between align-items-center border-bottom px-4"
    >
      <p class="popup-header">Select Branch</p>
      <button class="close-button" (click)="close()">&times;</button>
    </div>

    <!-- Search Bar -->
    <div class="px-3 pt-2">
      <div class="input-group">
        <span class="input-group-text">
          <mat-icon>search</mat-icon>
        </span>
        <input
          type="text"
          class="form-control search"
          placeholder="Search"
          aria-label="Search"
          aria-describedby="search-icon"
        />
      </div>
    </div>

    <div class="popup-body px-4 py-2">
      <div class="row mb-3 border-bottom pb-1">
        <div class="col-md-12 d-flex">
          <div class="col-md-6">
            <label> <input class="mr-2" type="checkbox" /> Branch Name </label>
          </div>
          <div class="col-md-6">
            <label>
              <input class="mr-2" type="checkbox" /> Branch Name 1
            </label>
          </div>
        </div>
      </div>
      <div class="row mb-3 border-bottom pb-1">
        <div class="col-md-12 d-flex">
          <div class="col-md-6">
            <label> <input class="mr-2" type="checkbox" /> Branch Name </label>
          </div>
          <div class="col-md-6">
            <label>
              <input class="mr-2" type="checkbox" /> Branch Name 1
            </label>
          </div>
        </div>
      </div>
      <div class="row mb-3 border-bottom pb-1">
        <div class="col-md-12 d-flex">
          <div class="col-md-6">
            <label> <input class="mr-2" type="checkbox" /> Branch Name </label>
          </div>
          <div class="col-md-6">
            <label>
              <input class="mr-2" type="checkbox" /> Branch Name 1
            </label>
          </div>
        </div>
      </div>
      <div class="row mb-3 border-bottom pb-1">
        <div class="col-md-12 d-flex">
          <div class="col-md-6">
            <label> <input class="mr-2" type="checkbox" /> Branch Name </label>
          </div>
          <div class="col-md-6">
            <label>
              <input class="mr-2" type="checkbox" /> Branch Name 1
            </label>
          </div>
        </div>
      </div>
      <div class="row mb-0 border-bottom pb-1">
        <div class="col-md-12 d-flex">
          <div class="col-md-6">
            <label> <input class="mr-2" type="checkbox" /> Branch Name </label>
          </div>
          <div class="col-md-6">
            <label>
              <input class="mr-2" type="checkbox" /> Branch Name 1
            </label>
          </div>
        </div>
      </div>
    </div>
    <div class="popup-footer px-4">
      <button
        mat-button
        style="width: 85px; height: 30px"
        id="save"
        (click)="save()"
      >
        OK
      </button>
    </div>
  </div>
</div>
